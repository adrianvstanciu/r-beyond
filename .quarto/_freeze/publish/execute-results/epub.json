{
  "hash": "c68847449b25854fc265df8f8f633bdd",
  "result": {
    "engine": "knitr",
    "markdown": "# Self-publish {#sec-publish}\n\n![](img/selfpublish.jpg){.lightbox width=50% fig-align=\"center\"}\n\nPublishing content online is very easy today. One can use WordPress and similar platforms to create a website, blogs and so on. \n\nWhy, then, use `r` to publish content online? \n\nThrough _R_ we can create websites and online books that we can store on online repositories like `GitHub` and maintain a high degree of control over the structure, contents, and visibility of the website/ book. Moreover, self-publishing using `r` is one way to integrate varying work-routines into a larger outcome - that of communicating own research, consultancy job involving data science, to name just a few examples. \n\nIf you work with data that comes from your data collection efforts or you use secondary data (publically available data), then self-publishing content online through `r` can facilitate the integration of data analysis and content creation steps.\n\nFor this section, we will use `quarto` to create both websites and books. Using `quarto` is a step forward from other approaches (new generation RMarkdown), including the way the present book was rendered - using the old generation RMarkdown files.  \n\n## Prepping Quarto {-}\n\n`Quarto` is a new generation `RMarkdown`. It retains all the functions of the RMarkdown files from before while it enhances and simplifies several other work flows. Basically, `Quarto` makes it much much much easier for everyone to create presentations, live documents, websites, books and so on. \n\nOne can even integrate `shiny` functionality into `Quarto` documents. For the present seminar, however, we will introduce `shiny apps` as separate tools (see Chapter \\@ref(apps)).\n\nSee the official website [here](https://quarto.org/).\n\nTo create content using `Quarto` we need:\n\n1 - `r`, which we download and install as described in Chapter \\@ref(runiv)\n\n2 - `RStudio`, which we download and install as described in Chapter \\@ref(runiv)\n\n3 - `Quarto`, which can be downloaded [here](https://quarto.org/docs/get-started/) and installed following the indicated steps. Make sure you choose the installation package that suits your operating system.\n\nAfter you've successfully installed `r`, `RStudio`, and `Quarto` on your computer, we can start with creating websites and books. \n\n## Website {-}\n\nIn @sec-autom, we've seen that working in `Rproj` simplifies the work flow including, for example, presetting path dependencies relative to the project folder.\n\n:::{#fig-qwebsite layout-ncol=2}\n\n![Step 1](img/qweb1.png){.lightbox width=75% #fig-step1qweb}\n\n![Step 2](img/qweb2.png){.lightbox width=75% #fig-step2qweb}\n\nSteps to creating a Quarto Website project\n:::\n\nWe will use the logic of projects here (and for books) as well. Open `RStudio` and create a new project `Quarto website`. See Figure @fig-qwebsite.\n\nWhen you create the project, there will be several files created by default: `.qmd`, `.yml`, `.css` as well as a folder \"_site\". The files and folder already contain the fundamental structure to a working website.\n\nTo open this default website on your local computer, navigate inside the folder \"_site\" and open on your Internet browser the `.html`^[`.html` files are specific types of file that are used online] file `index.html`. \n\nEvery website (and online book) has such an `index.html` file. This file indexes the other files composing the website (or book). \n\n### .qmd\n\n![Basic structure of a .qmd file](img/index.png){.lightbox width=75% #fig-indexqmd}\n\nWe can see the by now familiar structure including the yaml header at lines 1-3, the r code chunk at lines 9-11 and the static text.\n\nWe can also see the `Render` button on the upper bar where the `knit` button would be in an old generation RMarkdown file. \n\nWe can edit this file in virtually identically to any other `.Rmd` file. I say virtually identically because the `.qmd` file comes with extra benefits making it easier to control the formatting of content on the page. One can easily implement some `.html` featured such as `div` using the `:::{}` blocks^[Some div blocks require four : instead of three, for example ::::{}. Additional : indicate therefore upper levels of div code embededdness.]. Read more on the basics of `.qmd` [here](https://quarto.org/docs/output-formats/html-basics.html). \n\n![Two columns using div blocks](img/qcolmn.png){.lightbox width=75% #fig-qcolmn}\n\nSee for example how a two columned format looks like in Figure @fig-qcolmn. Include it in your `.qmd` filte and then render it. See how it looks.\n\n### .yml\n\n![Elements of the .yml file](img/qyml.png){.lightbox width=75% #fig-qyml}\n\nThree elements are observable when opening the default `.yml` file: `project`, `website`, and `format`. See Figure @fig-qyml.\n\nFirst, the element `project` defines the type of the project you work one. It can be a website as well as a book.\n\nSecond, the element `website` defines attributes of the website. In Figure @fig-qyml we can see attributes \"title\" and \"navbar\". `title` allows us to give a title to the website. `navbar` is short for navigation bar. Let us look a bit closer at it.\n\nInside `navbar` there is an element `left` which defines the positioning of the navigation bar. It can also be right, for example. On the `navbar` we then place the individual pages - which are none other the `html` renditions of the `.qmd` files. We see two ways to place these individual pages. \n\nOne is where we give a custom label to the page: see lines 8 and 9. Another where we use the default label that derives from the title of the individual page (remember that each RMarkdown file has a yaml header and so has every .qmd file).\n\n:::{#tip-navbar .callout-tip}\n## Listing all the individual pages\n\nRemember to list in the `navbar` all the individual pages you'd like to be rendered in the final website. Otherwise, the website will not contain them!\n:::\n\nThird, the element `format` allows us to format the website overall including, for example, a theme, css (cascading style sheets) or even add a table of contents (toc). `theme`, `css` and `toc` and attributes of the `html` document. Remember from Chapter \\@ref(autom) the concept of parameters? Well, that is pretty much the logic here as well - these three are parameters of the html file that we can modify according to our needs. This means that there are multiple themes we can choose from and we can write our very own `.css` style. We may decide to include a `toc` or not. \n\n:::{.callout-tip #tip-qthemes}\n## Further html themes\n\nSelect from [this](https://quarto.org/docs/output-formats/html-themes.html) list of quarto html themes the one you'd prefer\n:::\n\n### .css\n\nThe default `.css` file is empty. I would say that css is rather advanced so I won't cover it here. Typically, one can create custom css styles for their website or can download templates from the Internet. Be aware however what you download and from where.\n\nFor the purpose of this seminar the default `.css` is more than enough.\n\n### _site folder\n\nThis folder is created by default. It is the containing folder of the rendered html files and other elements required for the final website.\n\nFor the purpose of this seminar, this folder is important for us because it contains the `index.html` file. By opening it on our browser, we can inspect locally the rendered website.\n\n### Deployment\n\nOnce you've created and locally inspected your website, the next step is to deploy it (publish) it online. Remember from Chapter \\@ref(intro) that we would need an online repository like `GitHub` and, most importantly, to have an open and encrypted channel connecting the local machine and the server. \n\nOne other way to publish your site is through [quartopub.com](https://quartopub.com/). Open an account on quartopub.com. We will deploy the website using these two ways: `GitHub` and `quartopub.com`. I will describe a bit why you might want to choose one or the other. \n\n#### Via quartopub\n\nThis is a very simple way to deploy your website online. It is integrated seamlessly with `quarto` so you only need two lines of code in the Terminal. Really.\n\nFirst, we need to render the website. To link together all the files that we've created/ edited included the `.qmd`, `.yml` and `.css`. \n\nCopy the line below into the Terminal of your website project and run it.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquarto render\n```\n:::\n\n\n\nNext, we can publish it via quartopub provided that we have opened an account. \n\nCopy the line below into the Terminal of your website project and run it.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquarto publish quarto-pub\n```\n:::\n\n\n\nYou will notice some code running and finally that in the project folder there is a new yml file created `_publish.yml`. If you open it, you will notice among other the URL to your newly and publically available website.\n\nWith this approach you deploy the website on a remote server and your files remain available only locally on your machine. You also need to make sure that you render the website after each modification to files making up the website.\n\nThe created example is published through `quarto pub` [here](https://adrian-stanciu.quarto.pub/example-website/).\n\n#### Via GitHub Pages\n\nIn some situations you might want to deploy the website and upload the files comprising the website on a remorte repository. This means that your files can be made publically available for other to clone them or they are available to you on the \"cloud\". The website itself is deployed and everybody can access it but in addition everyone can have access to the files that create the website.\n\nThis approach might be preferable when you maintain a website as a group. Or when you create a fancy website together with colleagues from across the globe.\n\nI wrote a step-by-step guide explanation for older generation RMarkdown. This can be accessed [here](https://adrianstanciu.eu/sitedummy.html).\n\nReturning to Quarto Website and assuming that a `GitHub` account has been created, you may follow the steps [here](https://quarto.org/docs/publishing/github-pages.html). A summary of the steps are provided below:\n\n1 - Create a `Quarto Website` project on your local machine\n\n2 - Make the folder containing the `quarto` website a `git` repository^[In @sec-intro we covered the set up of GitHub and repositories including installing a suite of code. Make sure that is done before attempting to create the folder a `git` repository.]\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngit init\n```\n:::\n\n\n\n\n3 - Create an empty repository on your `GitHub` account. Then, connect the local repository to the newly created online repository.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nremote add origin git@github.com:{your github user}/{your repository where the website will be hosted}.git\n```\n:::\n\n\n\n4 - We will deploy the website by rendering it to a sub-folder docs. To do this we need to modify the `_quarto.yml` document. Open the `.yml` file, copy the following line and paste it as a sub-element to \"project\". This new line should be intended and be aligned with the \"type: website\" element! Save and close the `.yml` file.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\noutput-dir: docs\n```\n:::\n\n\n\n5 - Create a `.nojekyll` file to the repository. Explanation is given [here](https://quarto.org/docs/publishing/github-pages.html). Go to the Terminal of the website project and run the code line:\n\nMac/ Linux\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntouch .nojekyll\n```\n:::\n\n\n\nWindows\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncopy NUL .nojekyll\n```\n:::\n\n\n\n6 - Render the website. Note that the website will be automatically rendered in the sub-folder `docs`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquarto render\n```\n:::\n\n\n\n7 - We push everything to our `GitHub` repository. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngit add .\ngit commit -m \"Push website\"\ngit push\n```\n:::\n\n\n\n8 - Check that the push was successful. \n\n![Contents of the created GitHub repository](img/repocheck.png){.lightbox width=75% #fig-repocheck}\n\nGo on your `GitHub` account, open the repository and it should look something like Figure @fig-repocheck.\n\n9 - Setup `GitHub` to \"read\" the website from the sub-folder `docs`. \n\n![Setup for deployment from main/docs](img/deploydocs.png){.lightbox width=75% #fig-deploydocs}\n\nNavigate to Settings/ Pages and change under \"Build and deployment\" the branch and folder according to Figure @fig-deploydocs. Save changes.\n\n10 - A visit site panel will appear shortly, after the website has been rendered and created, like in Figure @fig-deploydocs. This may take between a few seconds and a couple of minutes depending on the server availability. Refresh the page and the website is now publically accessible.\n\n11 - Now you can repeat steps 6 through 8 every time you edited or modified contents for your website. The website itself will be updated automatically (might take a couple of minutes though).\n\nThe created example is published via `GitHub pages` [here](https://adrianstanciu.eu/example/)^[Note that I am using a custom domain at the root of which is my personal website. In your case it would have a slightly different domain but the website itself will look similar to the example shown.].\n\n:::{.callout-tip #tip-customdomain}\n## Custom domains\nYou can publish your website (or book, as we will see in the next section) on a custom domain. For this you'd need to pay a monthly or yearly fee. \n\nSee for details this [ultra-brief guide](https://adrianstanciu.eu/sitedummy.html#2_The_personalized_one) I wrote some time ago but still remains valid.\n:::\n\n## Online book {-}\n\n## Deployment \n\n### Quarto\n\nBook deployment is almost identical with the deployment of websites. \n\nThe easiest option is to deploy through `quarto pub`. To do this, we only need to do the following:\n\n1 - Make sure we have opened an account on [quarto.com](https://quartopub.com/)\n\n2 - render the book using the line code below (identical to the one used for websites)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquarto render\n```\n:::\n\n\n\nIt may take a couple of seconds until the book is rendered. And, if it is the first time you render a qurto book it may take a bit until the necessary dependencies are installed. \n\n3 - Publish the book using one line of code.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquarto publish quarto-pub\n```\n:::\n\n\n\nThe example book was published online through `quarto.pub` [here](https://adrian-stanciu.quarto.pub/example-book/).\n\n### GitHub \n\nThe example book was published online via `GitHub pages` [here](https://adrianstanciu.eu/example-book/). Similar to the website example, the book is attributed to my personal website.\n\n## Advanced resources {-}\n\nThere are some alternatives out there, for example:\n\n- using the `blogdown` package. See a step-by-step [guide](https://www.shilaan.com/post/building-your-website-using-r-blogdown/) by Shilaan Alzahawi.\n\n- using the `distill` package. See a [guide](https://www.shilaan.com/post/building-your-website-using-r-blogdown/) by Sally A.M. Hogenboom. \n\n- a more comprenesive guide to creating a website using `r` and `RStudio` is provided in this [eBook](https://r4sites-book.netlify.app/) by Danny Morris.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}